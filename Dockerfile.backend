# Node.js后端服务Dockerfile
FROM node:20-alpine

# 设置工作目录
WORKDIR /app

# 复制package文件并安装依赖
COPY package.json ./
COPY pnpm-lock.yaml ./
RUN npm config set registry https://registry.npmmirror.com && \
    npm install -g pnpm && \
    pnpm config set registry https://registry.npmmirror.com && \
    pnpm install

# 复制项目文件
COPY . .

# 创建日志目录
RUN mkdir -p /app/logs

# 暴露端口
EXPOSE 4431

# 启动后端服务
CMD ["pnpm", "start:backend"]